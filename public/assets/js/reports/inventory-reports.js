var drugUsagePackageReport=function(){let t;return{init:function(e,a,n){!function(e,a,n){t=$("#drugUsagePackageTable").DataTable({rowGroup:{dataSrc:"item_code",startRender:function(t,e){const a=t.data();return $("<tr/>").append(`<th class="nowrap">${a.pluck("item_code")[0]}</th>`).append(`<th class="nowrap">${a.pluck("item_name")[0]}</th>`).append(`<th class="nowrap text-end">${cms.numberWithCommas(parseFloat(a.pluck("qty")[0]).toFixed(2))}</th>`).append(`<th class="nowrap">${cms.isNull(a.pluck("uom")[0],"")}</th>`).append(`<th class="nowrap text-end">${a.pluck("currency_symbol")[0]}${cms.numberWithCommas(parseFloat(a.pluck("cost_amount")[0]).toFixed(2))}</th>`).append(`<th class="nowrap text-end">${a.pluck("currency_symbol")[0]}${cms.numberWithCommas(parseFloat(a.pluck("sell_amount")[0]).toFixed(2))}</th>`).append(`<th class="nowrap text-end">${a.pluck("currency_symbol")[0]}${cms.numberWithCommas(parseFloat(a.pluck("profit")[0]).toFixed(2))}</th>`).append(`<th colspan="5">${a.pluck("branch")[0]}</th>`)}},paging:!1,info:!1,searching:!1,ordering:!1,processing:!0,serverSide:!0,ajax:{url:`${_url}/drug-usage-package-data`,type:"POST",contentType:"application/json; charset=utf-8",data:function(t){return t.startDate=e,t.endDate=a,t.patient=n,JSON.stringify(t)}},columns:[{data:"prod_code",name:"prod_code",class:"ps-4"},{data:"prod_name",name:"prod_name"},{data:"prod_qty",name:"prod_qty",class:"text-end",render:function(t){return cms.numberWithCommas(parseFloat(t).toFixed(2))}},{data:"prod_uom",name:"prod_uom"},{data:null,name:"cost_amount",render:function(){return""}},{data:null,name:"sell_amount",render:function(){return""}},{data:null,name:"profit",render:function(){return""}},{data:"branch",name:"branch"}],order:[[0,"desc"]],createdRow:function(t,e,a){}})}(e,a,n)},printReport:function(){const t=$($("#drugUsagePackageReportContainer").html().replace(/<thead>/g,"").replace(/<\/thead>/g,"").replace(/<tfoot>/g,"").replace(/<\/tfoot>/g,""));t.find(".table").attr("class","print-table border-top border-end border-dark fs-10px").width("100%").find("td,th").addClass("p-1 border-bottom border-start border-dark"),$("#printBody").html(t),$("#printContainer").print()}}}(),drugUsageProductReport=function(){let t;return{init:function(e,a,n){!function(e,a,n){t=$("#drugUsageProductTable").DataTable({paging:!1,info:!1,searching:!1,ordering:!1,processing:!0,serverSide:!0,ajax:{url:`${_url}/drug-usage-product-data`,type:"POST",contentType:"application/json; charset=utf-8",data:function(t){return t.startDate=e,t.endDate=a,t.patient=n,JSON.stringify(t)}},columns:[{data:"item_code",name:"item_code"},{data:"item_name",name:"item_name"},{data:"qty",name:"qty",class:"text-end",render:function(t){return cms.numberWithCommas(parseFloat(t).toFixed(2))}},{data:"uom",name:"uom"},{data:"cost_amount",name:"cost_amount",class:"text-end"},{data:"sell_amount",name:"sell_amount",class:"text-end"},{data:"profit",name:"profit",class:"text-end"},{data:"branch",name:"branch"}],order:[[0,"desc"]],createdRow:function(t,e,a){let n=$(t);n.find("td:eq(4)").html(`${e.currency_symbol}${null==e.cost_amount?"0.00":cms.numberWithCommas(parseFloat(e.cost_amount).toFixed(2))}`),n.find("td:eq(5)").html(`${e.currency_symbol}${null==e.sell_amount?"0.00":cms.numberWithCommas(parseFloat(e.sell_amount).toFixed(2))}`),n.find("td:eq(6)").html(`${e.currency_symbol}${null==e.profit?"0.00":cms.numberWithCommas(parseFloat(e.profit).toFixed(2))}`)}})}(e,a,n)},printReport:function(){const t=$($("#drugUsageProductReportContainer").html().replace(/<thead>/g,"").replace(/<\/thead>/g,"").replace(/<tfoot>/g,"").replace(/<\/tfoot>/g,""));t.find(".table").attr("class","print-table border-top border-end border-dark fs-10px").width("100%").find("td,th").addClass("p-1 border-bottom border-start border-dark"),$("#printBody").html(t),$("#printContainer").print()}}}(),stockAdjustmentReport=function(){let t;return{init:function(e,a,n,r,o){!function(e,a,n,r,o){t=$("#stockAdjustmentTable").DataTable({paging:!1,info:!1,searching:!1,ordering:!1,processing:!0,serverSide:!0,ajax:{url:`${_url}/stock-adjustment-data`,type:"POST",contentType:"application/json; charset=utf-8",data:function(t){return t.startDate=n,t.endDate=r,t.product=a,t.type=o,JSON.stringify(t)}},columns:[{data:"adjustment_date",name:"adjustment_date",render:function(t){return cms.formatDate(t)}},{data:"code",name:"code"},{data:"type",name:"type"},{data:"item_code",name:"item_code"},{data:"item_name",name:"item_name"},{data:"batch_no",name:"batch_no",visible:e},{data:"expiry_date",name:"expiry_date",visible:e,render:function(t){return null!=t?cms.formatDate(t):""}},{data:"current_stock",name:"current_stock",render:function(t){return cms.numberWithCommas(parseFloat(t).toFixed(2))}},{data:"qty",name:"qty",render:function(t){return cms.numberWithCommas(parseFloat(t).toFixed(2))}},{data:"updated_stock",name:"updated_stock",render:function(t){return cms.numberWithCommas(parseFloat(t).toFixed(2))}},{data:"uom",name:"uom"},{data:"adjusted_by",name:"adjusted_by"},{data:"branch",name:"branch"}],order:[[0,"asc"],[1,"asc"]],createdRow:function(t,e,a){}})}(e,a,n,r,o)},printReport:function(){const t=$($("#stockAdjustmentReportContainer").html().replace(/<thead>/g,"").replace(/<\/thead>/g,"").replace(/<tfoot>/g,"").replace(/<\/tfoot>/g,""));t.find(".table").attr("class","print-table border-top border-end border-dark fs-10px").width("100%").find("td,th").addClass("p-1 border-bottom border-start border-dark"),$("#printBody").html(t),$("#printContainer").print()},toggleColumn:function(e){t.columns([5,6]).visible(e)}}}(),itemDispensedReport=function(){let t;return{init:function(a,n,r,o,s,d){!function(a,n,r,o,s,d){t=$("#itemDispensedTable").DataTable({paging:!1,info:!1,searching:!1,ordering:!1,processing:!0,serverSide:!0,ajax:{url:`${_url}/item-dispensed-data`,type:"POST",contentType:"application/json; charset=utf-8",data:function(t){return t.startDate=r,t.endDate=o,t.product=n,t.category=s,t.type=d,JSON.stringify(t)}},columns:[{data:"time_in",name:"time_in",render:function(t){return cms.formatDate(t)}},{data:"item_code",name:"item_code"},{data:"name",name:"name"},{data:"qty",name:"qty",render:function(t){return cms.numberWithCommas(parseFloat(t).toFixed(2))}},{data:"uom",name:"uom"},{data:"category",name:"category"},{data:"type",name:"type"},{data:"unit_price",name:"unit_price"},{data:"total_amount",name:"total_amount"},{data:"disc_amount",name:"disc_amount"},{data:"sub_total",name:"sub_total"},{data:"code",name:"code"},{data:"patient",name:"patient"},{data:"branch",name:"branch"}],order:[[0,"asc"],[1,"asc"]],createdRow:function(t,e,a){let n=$(t);null!=e.unit_price&&n.find("td:eq(7)").text(`${e.currency_symbol}${cms.numberWithCommas(parseFloat(e.unit_price).toFixed(2))}`),null!=e.total_amount&&n.find("td:eq(8)").text(`${e.currency_symbol}${cms.numberWithCommas(parseFloat(e.total_amount).toFixed(2))}`),null!=e.disc_amount&&n.find("td:eq(9)").text(`${e.currency_symbol}${cms.numberWithCommas(parseFloat(e.disc_amount).toFixed(2))}${0!=cms.isNull(e.disc_percentage,0)?` (${cms.numberWithCommas(parseFloat(e.disc_percentage).toFixed(2))}%)`:""}`),null!=e.sub_total&&n.find("td:eq(10)").text(`${e.currency_symbol}${cms.numberWithCommas(parseFloat(e.sub_total).toFixed(2))}`)},drawCallback:function(){e(a)}})}(a,n,r,o,s,d)},printReport:function(){const t=$($("#itemDispensedReportContainer").html().replace(/<thead>/g,"").replace(/<\/thead>/g,"").replace(/<tfoot>/g,"").replace(/<\/tfoot>/g,""));t.find(".table").attr("class","print-table border-top border-end border-dark fs-10px").width("100%").find("td,th").addClass("p-1 border-bottom border-start border-dark"),$("#printBody").html(t),$("#printContainer").print()},toggleColumn:e};function e(e){t.columns([7,8,9]).visible(e)}}(),purchaseDeliveryReport={init:function(t,e,a,n){!function(t,e,a,n){$("#purchaseDeliveryTable").DataTable({paging:!1,info:!1,searching:!1,ordering:!1,processing:!0,serverSide:!0,ajax:{url:`${_url}/purchase-delivery-data`,type:"POST",contentType:"application/json; charset=utf-8",data:function(r){return r.startDate=t,r.endDate=e,r.supplier=a,r.deliveryStatus=n,JSON.stringify(r)}},columns:[{data:"order_date",name:"order_date",render:function(t){return cms.formatDate(t)}},{data:"code",name:"code"},{data:"po_no",name:"po_no"},{data:"supplier",name:"supplier"},{data:"item_count",name:"item_count",render:function(t){return cms.numberWithCommas(t)}},{data:"is_delivery_completed",name:"is_delivery_completed",render:function(t){let e="On Process",a="warning";return 1==t&&(e="Completed",a="success"),`<span class="text-${a}">${e}</span>`}},{data:"created_by",name:"created_by"},{data:"branch",name:"branch"}],order:[[0,"asc"],[1,"asc"]],createdRow:function(t,e,a){$(t)}})}(t,e,a,n)},printReport:function(){const t=$($("#purchaseDeliveryReportContainer").html().replace(/<thead>/g,"").replace(/<\/thead>/g,"").replace(/<tfoot>/g,"").replace(/<\/tfoot>/g,""));t.find(".table").attr("class","print-table border-top border-end border-dark fs-10px").width("100%").find("td,th").addClass("p-1 border-bottom border-start border-dark"),$("#printBody").html(t),$("#printContainer").print()}};$((function(){const t=$("#reportType"),e=$("#drFilter"),a=$(".purchase-delivery-filter-container"),n=$(".item-dispensed-filter-container"),r=$(".stock-adjustment-filter-container"),o=$(".drug-usage-filter-container"),s=$("#supplierFilter"),d=$("#deliveryStatusFilter"),c=$("#productFilter"),i=$("#categoryFilter"),l=$("#typeFilter"),m=$("#adjustmentTypeFilter"),u=$("#patientFilter"),p=$("#reportContainer"),h=$("#clearFilter"),g=$("#generate"),f=$("#print"),b=$("#detailedView");let y,_=!1;$(document).ready((function(){!function(){const t=moment();e.find("span").text(`${t.format("MMMM D, YYYY")} - ${t.format("MMMM D, YYYY")}`),e.daterangepicker({startDate:moment(),endDate:moment(),showDropdowns:!0,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")],"This Year":[moment().startOf("year"),moment().endOf("year")]}},(function(t,a,n){e.find("span").html(t.format("MMMM D, YYYY")+" - "+a.format("MMMM D, YYYY"))})),y=e.data("daterangepicker"),s.select2({placeholder:"All Suppliers",closeOnSelect:!1}),c.select2({placeholder:"All Products",closeOnSelect:!1}),i.select2({placeholder:"All Categories",closeOnSelect:!1}),l.select2({placeholder:"All types",closeOnSelect:!1}),m.select2({placeholder:"All types",closeOnSelect:!1}),u.select2({placeholder:"All Patients",closeOnSelect:!1})}(),t.change((function(){switch(a.hide(),n.hide(),r.hide(),o.hide(),b.show(),t.find("option:selected").text()){case"Purchase Delivery":a.show(),b.hide();break;case"Item Dispensed":n.show();break;case"Stock Adjustment":r.show();break;case"Drug Usage (Product)":case"Drug Usage (Package)":o.show(),b.hide()}setTimeout((()=>{h.trigger("click")}),0)})),t.trigger("change"),h.click((function(){p.html(""),s.val(null).trigger("change"),u.val(null).trigger("change"),c.val(null).trigger("change"),i.val(null).trigger("change"),l.val(null).trigger("change"),m.val(null).trigger("change")})),g.click((function(){const e=y.startDate.format("YYYY-MM-DD"),a=y.endDate.format("YYYY-MM-DD");p.load(`${t.val()}?startDate=${e}&endDate=${a}`,(function(){switch(t.find("option:selected").text()){case"Purchase Delivery":purchaseDeliveryReport.init(e,a,s.val(),d.val());break;case"Item Dispensed":itemDispensedReport.init(_,c.val(),e,a,i.val(),l.val());break;case"Stock Adjustment":stockAdjustmentReport.init(_,c.val(),e,a,m.val());break;case"Drug Usage (Product)":drugUsageProductReport.init(e,a,u.val());break;case"Drug Usage (Package)":drugUsagePackageReport.init(e,a,u.val())}}))})),f.click((function(){switch(t.find("option:selected").text()){case"Purchase Delivery":purchaseDeliveryReport.printReport();break;case"Item Dispensed":itemDispensedReport.printReport();break;case"Stock Adjustment":stockAdjustmentReport.printReport();break;case"Drug Usage (Product)":drugUsageProductReport.printReport();break;case"Drug Usage (Package)":drugUsagePackageReport.printReport()}})),b.click((function(){switch(b.toggleClass("btn-white btn-primary"),_=b.hasClass("btn-primary"),t.find("option:selected").text()){case"Item Dispensed":itemDispensedReport.toggleColumn(_);break;case"Stock Adjustment":stockAdjustmentReport.toggleColumn(_)}}))}))}));
